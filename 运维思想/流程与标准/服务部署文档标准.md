# 服务部署文档标准

## 适用范围

本文档规范适用于公司内所有部署的程序，部署方式包括以下方式：

- 直接在服务器上部署
- docker部署
- docker-compose部署
- kubenetes部署

服务在部署完成后必须形成部署标准文档。

相关文档经**运维负责人审核后** ，上传到confluence文档仓库。



## RACI

|          | 服务部署实施人员 | 运维负责人 | 运维小组其他人员 |
| -------- | ---------------- | ---------- | ---------------- |
| 文档编写 | R                |            |                  |
| 文档上传 | R                | A          | I                |



## 部署规范

部署实施完成后，部署文档需要包涵以下内容

1. 部署环境/软件版本
2. 服务基础知识介绍/服务知识文档
3. 自动化部署文档
4. 监控文档
5. 日志收集文档
6. 服务安装包

其中`文档1` `文档2` `文档4` `文档6`是必须文档，既部署文档中必须包含 `部署环境/软件版本` `部署文档` `监控文档` `服务安装包`。

平台类服务部署可以不包含`文档3`，平台类服务类似于`Jenkins` `confluence`等。

### 部署环境/软件版本

这一部分必须对一下项目进行详细的描述

- 操作系统类型与版本
- 依赖的程序与依赖程序版本
- 实施部署的程序的版本

###服务基础知识介绍/服务知识文档

这一部分的文档着重从以下几个方面进行描述：

- 服务原理
- 服务架构体系
- 服务的安装与部署
- 服务常用API调用，如果有restful或者python调用方式的需要着重描述。
- 服务的备份与恢复

### 自动化部署文档

自动化部署文档分为多种类型，主要根据服务的部署类型进行区分。

| 编号 | 部署类型           | 文档标准                              |
| ---- | ------------------ | ------------------------------------- |
| 1    | 直接在服务器上部署 | ansible playbooks 文档                |
| 2    | docker部署         | docker 启动语句                       |
| 3    | docker-compose部署 | docker-compose 标准文档               |
| 4    | kubenetes 部署     | kubenetes yaml文档文件 或者 helm 文档 |

### 监控文档/日志收集文档

- 监控文档

定义出服务的监控项目 或者 直接给出服务的监控方式。

**监控文档标准**依照监控标准流程中定义的标准执行

**服务的等级** 由监控的管理者制定

- 日志收集文档

日志收集为非必须文档，主要根据服务的类型进行判断，除了少部分不依赖日志的服务外，绝大多数的服务应该定义提供日志收集策略。

**日志收集文档**依照监控标准流程中定义的标准执行

### 服务安装包

服务安装包上传到公司 ftp 服务器。并对上传地址进行记录。
